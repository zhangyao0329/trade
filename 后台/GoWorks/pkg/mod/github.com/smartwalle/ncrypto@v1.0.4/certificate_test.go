package ncrypto_test

import (
	"github.com/smartwalle/ncrypto"
	"testing"
)

func TestParseCertificate(t *testing.T) {
	var testTbl = []struct{ key string }{
		{
			key: `-----BEGIN CERTIFICATE-----
MIIDjzCCAnegAwIBAgIQICIRFPij/mN/Cos8h7+rvDANBgkqhkiG9w0BAQsFADCBkTELMAkGA1UE
BhMCQ04xGzAZBgNVBAoMEkFudCBGaW5hbmNpYWwgdGVzdDElMCMGA1UECwwcQ2VydGlmaWNhdGlv
biBBdXRob3JpdHkgdGVzdDE+MDwGA1UEAww1QW50IEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eSBDbGFzcyAyIFIxIHRlc3QwHhcNMjIxMTE0MDYyNDI2WhcNMjMxMTE5MDYyNDI2WjBh
MQswCQYDVQQGEwJDTjEVMBMGA1UECgwM5rKZ566x546v5aKDMQ8wDQYDVQQLDAZBbGlwYXkxKjAo
BgNVBAMMITIwODgxMDIxNjkyMjc1MDMtMjAxNjA3MzEwMDEyOTUzNzCCASIwDQYJKoZIhvcNAQEB
BQADggEPADCCAQoCggEBAJhfy+PppHohU2gnksug6DgdzhjihZixJcf+aYDrjzxhy14wbJOl/vCK
tFakYboN4RZ3UjweHvFMSn7V5s42LMJYXBARv4bgZU0IYimzQKuyImtS97SLPr1fJRLhSZSPZWcD
n3MxyA6N4GGRSpxLpsi57VqubHm2JIWs4PTRueg/XAXlz8+6z8ysM1Zowi/B5AeAZLxGWFKsNFhZ
uhhbdD3NFTnAsKIqPaEZWToFSP5Bwhmy3woYCQKrPiHdaWDrwdAqGL+PbmlxuKqnFAhubVvRBPyF
VAl0Y1e/r/cqXfj3ozchVrQvuUuiPMVWty45jKRa/PNZ/kLSnmEKtIRYowUCAwEAAaMSMBAwDgYD
VR0PAQH/BAQDAgTwMA0GCSqGSIb3DQEBCwUAA4IBAQBpQ0OtGGb0DvR6KJzeaidZ0Wt3My9w1w+C
XYXn8R5RCsE6Q1t2Dd0hSYES0TWOXbLhQG3cVIjzLOud5TCZFxWLGyJT5n2wqnM41kMPq0Gh88Th
MO7EPw6cq4l7Zsf31s53nOueS+SGmcq9XG3gLLOn0rbxL22faKk4FzFWR3d/BXKUq6MAkCAFOOvH
G60wO3SEJb3itRcGEN3Io3cVKnr1pxcNYNs9fEJ3+tt0fasFmFv4XjelZKACsjJjFj6qa3co04hc
a0gxvmRV50iSBC24K4MkZ7M3nXId2kZgy0TEHBXhgMg69EEiuhs8ywlr9zzpHbSmr/MT8eZETAoQ
w8Cj
-----END CERTIFICATE-----`,
		},
		{
			key: `MIIDjzCCAnegAwIBAgIQICIRFPij/mN/Cos8h7+rvDANBgkqhkiG9w0BAQsFADCBkTELMAkGA1UE
BhMCQ04xGzAZBgNVBAoMEkFudCBGaW5hbmNpYWwgdGVzdDElMCMGA1UECwwcQ2VydGlmaWNhdGlv
biBBdXRob3JpdHkgdGVzdDE+MDwGA1UEAww1QW50IEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1
dGhvcml0eSBDbGFzcyAyIFIxIHRlc3QwHhcNMjIxMTE0MDYyNDI2WhcNMjMxMTE5MDYyNDI2WjBh
MQswCQYDVQQGEwJDTjEVMBMGA1UECgwM5rKZ566x546v5aKDMQ8wDQYDVQQLDAZBbGlwYXkxKjAo
BgNVBAMMITIwODgxMDIxNjkyMjc1MDMtMjAxNjA3MzEwMDEyOTUzNzCCASIwDQYJKoZIhvcNAQEB
BQADggEPADCCAQoCggEBAJhfy+PppHohU2gnksug6DgdzhjihZixJcf+aYDrjzxhy14wbJOl/vCK
tFakYboN4RZ3UjweHvFMSn7V5s42LMJYXBARv4bgZU0IYimzQKuyImtS97SLPr1fJRLhSZSPZWcD
n3MxyA6N4GGRSpxLpsi57VqubHm2JIWs4PTRueg/XAXlz8+6z8ysM1Zowi/B5AeAZLxGWFKsNFhZ
uhhbdD3NFTnAsKIqPaEZWToFSP5Bwhmy3woYCQKrPiHdaWDrwdAqGL+PbmlxuKqnFAhubVvRBPyF
VAl0Y1e/r/cqXfj3ozchVrQvuUuiPMVWty45jKRa/PNZ/kLSnmEKtIRYowUCAwEAAaMSMBAwDgYD
VR0PAQH/BAQDAgTwMA0GCSqGSIb3DQEBCwUAA4IBAQBpQ0OtGGb0DvR6KJzeaidZ0Wt3My9w1w+C
XYXn8R5RCsE6Q1t2Dd0hSYES0TWOXbLhQG3cVIjzLOud5TCZFxWLGyJT5n2wqnM41kMPq0Gh88Th
MO7EPw6cq4l7Zsf31s53nOueS+SGmcq9XG3gLLOn0rbxL22faKk4FzFWR3d/BXKUq6MAkCAFOOvH
G60wO3SEJb3itRcGEN3Io3cVKnr1pxcNYNs9fEJ3+tt0fasFmFv4XjelZKACsjJjFj6qa3co04hc
a0gxvmRV50iSBC24K4MkZ7M3nXId2kZgy0TEHBXhgMg69EEiuhs8ywlr9zzpHbSmr/MT8eZETAoQ
w8Cj`,
		},
		{
			key: `MIIE4jCCAsqgAwIBAgIIYsSr5bKAMl8wDQYJKoZIhvcNAQELBQAwejELMAkGA1UEBhMCQ04xFjAUBgNVBAoMDUFudCBGaW5hbmNpYWwxIDAeBgNVBAsMF0NlcnRpZmljYXRpb24gQXV0aG9yaXR5MTEwLwYDVQQDDChBbnQgRmluYW5jaWFsIENlcnRpZmljYXRpb24gQXV0aG9yaXR5IFIxMB4XDTE4MDMyMjE0MzQxNVoXDTM3MTEyNjE0MzQxNVowgYIxCzAJBgNVBAYTAkNOMRYwFAYDVQQKDA1BbnQgRmluYW5jaWFsMSAwHgYDVQQLDBdDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTE5MDcGA1UEAwwwQW50IEZpbmFuY2lhbCBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSBDbGFzcyAyIFIxMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsLMfYaoRoPRbmDcAfXPCmKf43pWRN5yTXa/KJWO0l+mrgQvs89bANEvbDUxlkGwycwtwi5DgBuBgVhLliXu+R9CYgr2dXs8D8Hx/gsggDcyGPLmVrDOnL+dyeauheARZfA3du60fwEwwbGcVIpIxPa/4n3IS/ElxQa6DNgqxh8J9Xwh7qMGl0JK9+bALuxf7B541Gr4p0WENG8fhgjBV4w4ut9eQLOoa1eddOUSZcy46Z7allwowwgt7b5VFfx/P1iKJ3LzBMgkCK7GZ2kiLrL7RiqV+h482J7hkJD+ardoc6LnrHO/hIZymDxok+VH9fVeUdQa29IZKrIDVj65THQIDAQABo2MwYTAfBgNVHSMEGDAWgBRfdLQEwE8HWurlsdsio4dBspzhATAdBgNVHQ4EFgQUSqHkYINtUSAtDPnS8XoyoP9p7qEwDwYDVR0TAQH/BAUwAwEB/zAOBgNVHQ8BAf8EBAMCAQYwDQYJKoZIhvcNAQELBQADggIBAIQ8TzFy4bVIVb8+WhHKCkKNPcJe2EZuIcqvRoi727lZTJOfYy/JzLtckyZYfEI8J0lasZ29wkTta1IjSo+a6XdhudU4ONVBrL70U8Kzntplw/6TBNbLFpp7taRALjUgbCOk4EoBMbeCL0GiYYsTS0mw7xdySzmGQku4GTyqutIGPQwKxSj9iSFw1FCZqr4VP4tyXzMUgc52SzagA6i7AyLedd3tbS6lnR5BL+W9Kx9hwT8L7WANAxQzv/jGldeuSLN8bsTxlOYlsdjmIGu/C9OWblPYGpjQQIRyvs4Cc/mNhrh+14EQgwuemIIFDLOgcD+iISoN8CqegelNcJndFw1PDN6LkVoiHz9p7jzsge8RKay/QW6C03KNDpWZEUCgCUdfHfo8xKeR+LL1cfn24HKJmZt8L/aeRZwZ1jwePXFRVtiXELvgJuM/tJDIFj2KD337iV64fWcKQ/ydDVGqfDZAdcU4hQdsrPWENwPTQPfVPq2NNLMyIH9+WKx9Ed6/WzeZmIy5ZWpX1TtTolo6OJXQFeItMAjHxW/ZSZTok5IS3FuRhExturaInnzjYpx50a6kS34c5+c8hYq7sAtZ/CNLZmBnBCFDaMQqT8xFZJ5uolUaSeXxg7JFY1QsYp5RKvj4SjFwCGKJ2+hPPe9UyyltxOidNtxjaknOCeBHytOr`,
		},
	}

	for _, test := range testTbl {
		var _, err = ncrypto.DecodeCertificate([]byte(test.key))
		if err != nil {
			t.Fatal(err)
		}
	}
}
